<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itcast.mapper.CheckItemMapper">

    <insert id="add" parameterType="com.itcast.pojo.CheckItem">
    INSERT INTO t_checkitem (
              code,
              name,
              sex,
              age,
              price,
              type,
              attention,
              remark
            )
    VALUES(
            #{code},
            #{name},
            #{sex},
            #{age},
            #{price},
            #{type},
            #{attention},
            #{remark}
          )
    </insert>

    <select id="findByCondition" resultType="com.itcast.pojo.CheckItem" parameterType="String">
        SELECT
        id,
        code,
        name,
        sex,
        age,
        price,
        type,
        attention,
        remark
        FROM
        t_checkitem
        <if test="value!=null and value.length !=0">
            WHERE code like #{value} or name like #{value}
        </if>
    </select>

    <delete id="deleteById" parameterType="integer">
        DELETE
        FROM
          t_checkitem
        WHERE id = #{id} ;
    </delete>

    <select id="findCountByCheckItemId" parameterType="integer" resultType="long">
        SELECT
          COUNT(*)
        FROM
          t_checkgroup_checkitem
        WHERE checkitem_id = #{id}
    </select>

    <select id="findById" resultType="com.itcast.pojo.CheckItem">
        SELECT
          id,
          code,
          name,
          sex,
          age,
          price,
          type,
          attention,
          remark
        FROM
          t_checkitem
        WHERE id = #{id}
    </select>


    <update id="update" parameterType="com.itcast.pojo.CheckItem">
        UPDATE t_checkitem

        <set>
            <if test="name!=null">
                 name = #{name},
            </if>

            <if test="sex!=null">
                 sex = #{sex},
            </if>

            <if test="code!=null">
                 code = #{code},
            </if>

            <if test="age!=null">
                 age = #{age},
            </if>

            <if test="price!=null">
                 price = #{price},
            </if>

            <if test="type!=null">
                 type = #{type},
            </if>

            <if test="attention!=null">
                 attention = #{attention},
            </if>

            <if test="remark!=null">
                 remark = #{remark},
            </if>
        </set>

        where id = #{id}
    </update>

    <select id="findCodeCount" parameterType="string" resultType="integer">
        SELECT
          COUNT(*)
        FROM
          t_checkitem
        WHERE code = #{code}
    </select>

    <select id="findNameCount" parameterType="string" resultType="integer">
        SELECT
          COUNT(*)
        FROM
          t_checkitem
        WHERE name = #{name}
    </select>

    <select id="findAll" resultType="com.itcast.pojo.CheckItem">
        SELECT
          id,
          code,
          name,
          sex,
          age,
          price,
          TYPE,
          attention,
          remark
        FROM
          t_checkitem
    </select>

    <select id="findAllInfoById" parameterType="integer" resultType="com.itcast.pojo.CheckItem">
        SELECT
          *
        FROM
          `t_checkitem`
        WHERE id IN
          (SELECT
            `checkitem_id`
          FROM
            `t_checkgroup_checkitem`
          WHERE `checkgroup_id` = #{checkgroup_id})
    </select>



</mapper>